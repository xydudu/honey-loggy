<!doctype html>
<html>
    <head>
        <title>Trace Time of All Actions</title>
        <link href="//cdn.bootcss.com/vis/4.17.0/vis.min.css" rel="stylesheet" type="text/css" />
        <link href="//cdn.bootcss.com/vis/4.17.0/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css" />
        <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
        <script src="//cdn.bootcss.com/vis/4.17.0/vis.min.js"></script>
        <script src="//cdn.bootcss.com/moment.js/2.17.0/moment.min.js"></script>
        <style>
            #box{
                box-sizing: border-box;
                width: 100%;
                height: 300px;
            }
        </style>
    </head>
    <body>
        <h1>Time Monitor<h1>
        <div id="box"></div>
        <script>
            $(function() {
                $.getJSON('/timegroup/list', function(_data) {
                    var groups = new vis.DataSet($.map(_data, function(_item, _i) {
                        return {id: _i, content: _i, value: _i}
                    }))
                    var items_arr = []
                    $.each(_data, function(_i, _item) {
                        $.each(_item, function(_ii, _iitem) {
                            items_arr.push({
                                type: _iitem.start ? 'range' : 'point',
                                id: _iitem.timestamp + Math.random(),
                                group: _i,
                                content: _iitem.desc,
                                start: ~~ (_iitem.start || _iitem.timestamp),
                                end: ~~_iitem.end || 'None'
                            })
                        })
                            
                    })
                    console.log(items_arr)
                    var items = new vis.DataSet(items_arr)
                    var container = document.getElementById('box')
                    var timeline = new vis.Timeline(container)
                    timeline.setGroups(groups)
                    timeline.setItems(items)

                })
            })

        </script>
    </body>
</html>
