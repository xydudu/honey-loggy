<!doctype html>
<html>
    <head>
        <title>Trace Time of All Actions</title>
        <link href="//cdn.bootcss.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
        <script src="//cdn.bootcss.com/moment.js/2.17.0/moment.min.js"></script>
        <style>
            ul {
                list-style: none;
                margin: 10px 0;
                padding: 0;
            }
            li {
                float: left;
                padding: 5px;
                font-size: 11px;
                margin: 1px;
            }
            html, body, #box {
                width: 1000000px;
            }
        </style>
    </head>
    <body>
        <h1>Time Monitor</h1>
        <div class="container" id="box"></div>
        <script>
            $(function() {
                
                var box = $('#box')
                box.html('loading...')
                $.getJSON('/timegroup/list', function(_data) {
                //$.getJSON('/list.json', function(_data) {
                    if (!_data.length) {
                        box.html('No data yet!')
                        return false
                    }
                    box.html('')
                    $.each(_data, function(_i, _item) {
                        var ul = $('<ul />').addClass('row')
                        var h3 = $('<h3 />').html(_item[0].desc)
                        $.each(_item, function(_i, _item) {
                            var w = _item.start ? (0.05 * (~~_item.end - ~~_item.start)) : 50
                            var li = $('<li style="width: '+ w +'px; background-color: red"></li>') 
                            li.html((~~_item.end - ~~_item.start).toFixed() +'ms') 
                            if(w < 50) {
                                li.width('auto')
                            }
                            if (w === 50) {
                                li.html('-').css('background-color','green').css('color', 'green').width('1px')
                            }
                            ul.append(li)
                        })
                        box.append(h3)
                        box.append(ul)
                    })
                })
            })

        </script>
    </body>
</html>
